language: python
output_sdk: exist-repo/coze-py-generated
api:
  packages:
    - name: api_apps
      source_dir: cozepy/api_apps
      client_class: APIAppsClient
      async_client_class: AsyncAPIAppsClient
      model_schemas:
        - schema: AppTypeOpen
          name: AppType
        - schema: ApiAppOpenV2
          name: APIApp
          field_order:
            - id
            - app_type
            - verify_token
            - name
            - connector_id
            - callback_url
      empty_models:
        - UpdateAPIAppsResp
        - DeleteAPIAppsResp
      child_clients:
        - attribute: events
          module: .events
          sync_class: APIAppsEventsClient
          async_class: AsyncAPIAppsEventsClient
      path_prefixes:
        - /v1/api_apps
    - name: apps
      source_dir: cozepy/apps
      extra_imports:
        - module: cozepy.bots
          names:
            - PublishStatus
      model_schemas:
        - schema: properties_data_properties_items_items
          name: SimpleApp
          field_order:
            - id
            - name
            - description
            - icon_url
            - is_published
            - owner_user_id
            - updated_at
            - folder_id
            - published_at
          required_fields:
            - id
            - name
            - description
            - icon_url
            - is_published
            - owner_user_id
            - updated_at
      path_prefixes:
        - /v1/apps
    - name: audio
      source_dir: cozepy/audio
      child_clients:
        - attribute: rooms
          module: .rooms
          sync_class: RoomsClient
          async_class: AsyncRoomsClient
          nil_check: is_none
          init_with_keywords: true
        - attribute: speech
          module: .speech
          sync_class: SpeechClient
          async_class: AsyncSpeechClient
          nil_check: is_none
          init_with_keywords: true
        - attribute: transcriptions
          module: .transcriptions
          sync_class: TranscriptionsClient
          async_class: AsyncTranscriptionsClient
          nil_check: is_none
          init_with_keywords: true
        - attribute: voices
          module: .voices
          sync_class: VoicesClient
          async_class: AsyncVoicesClient
          nil_check: is_none
          init_with_keywords: true
        - attribute: voiceprint_groups
          module: .voiceprint_groups
          sync_class: VoiceprintGroupsClient
          async_class: AsyncVoiceprintGroupsClient
          nil_check: is_none
          init_with_keywords: true
        - attribute: live
          module: .live
          sync_class: LiveClient
          async_class: AsyncLiveClient
          nil_check: is_none
          init_with_keywords: true
      path_prefixes:
        - /v1/audio
    - name: bots
      source_dir: cozepy/bots
      extra_imports:
        - module: pydantic
          names:
            - Field
            - field_validator
      model_schemas:
        - schema: PublishStatus
          name: PublishStatus
          enum_base: dynamic_str
        - schema: PromptInfo
          name: BotPromptInfo
          required_fields:
            - prompt
        - schema: OnboardingInfoV2
          name: BotOnboardingInfo
          field_types:
            suggested_questions: Optional[List[str]]
          field_defaults:
            prologue: '""'
            suggested_questions: "[]"
        - schema: properties_knowledge
          name: BotKnowledge
          field_order:
            - dataset_ids
            - auto_call
            - search_strategy
          field_defaults:
            dataset_ids: "[]"
            auto_call: "True"
            search_strategy: "0"
        - schema: properties_model_info_config
          name: BotModelInfo
          prepend_code:
            - |
              class ResponseFormat(DynamicStrEnum):
                  JSON = "json"
                  TEXT = "text"
                  MARKDOWN = "markdown"

              class CacheType(DynamicStrEnum):
                  CLOSED = "closed"
                  PREFIX = "prefix"
          field_order:
            - model_id
            - model_name
            - temperature
            - context_round
            - max_tokens
            - response_format
            - top_k
            - top_p
            - cache_type
            - presence_penalty
            - frequency_penalty
            - parameters
            - sp_anti_leak
            - sp_current_time
          required_fields:
            - model_id
          field_types:
            response_format: Optional[ResponseFormat]
            cache_type: Optional[CacheType]
            parameters: Optional[Dict[str, str]]
          extra_fields:
            - name: model_name
              type: str
              required: false
        - schema: properties_plugin_id_list
          name: PluginIDList
          prepend_code:
            - |
              class PluginIDInfo(CozeModel):
                  plugin_id: str
                  api_id: str
          field_types:
            id_list: Optional[List[PluginIDInfo]]
        - schema: properties_workflow_id_list
          name: WorkflowIDList
          prepend_code:
            - |
              class WorkflowIDInfo(CozeModel):
                  id: str
          field_types:
            ids: Optional[List[WorkflowIDInfo]]
        - schema: BotMode
          name: BotMode
          enum_base: int
          enum_values:
            - name: SINGLE_AGENT
              value: 0
            - name: MULTI_AGENT
              value: 1
            - name: SINGLE_AGENT_WORKFLOW
              value: 2
        - schema: ApiInfo
          name: BotPluginAPIInfo
          field_order:
            - api_id
            - name
            - description
          required_fields:
            - api_id
            - name
            - description
        - schema: PluginInfo
          name: BotPluginInfo
          field_order:
            - plugin_id
            - name
            - description
            - icon_url
            - api_info_list
          required_fields:
            - plugin_id
            - name
            - description
            - icon_url
            - api_info_list
          field_types:
            api_info_list: List[BotPluginAPIInfo]
        - schema: SuggestReplyMode
          name: SuggestReplyMode
          enum_base: dynamic_str
          enum_values:
            - name: DISABLE
              value: disable
            - name: ENABLE
              value: enable
            - name: CUSTOMIZED
              value: customized
        - schema: properties_suggest_reply_info
          name: BotSuggestReplyInfo
          required_fields:
            - reply_mode
          field_types:
            reply_mode: SuggestReplyMode
          field_defaults:
            customized_prompt: '""'
        - schema: GradientPosition1
          name: GradientPosition
        - schema: CanvasPosition1
          name: CanvasPosition
          field_order:
            - width
            - height
            - left
            - top
        - schema: BackgroundImageDetail
          name: BackgroundImageInfo
          field_order:
            - image_url
            - theme_color
            - gradient_position
            - canvas_position
          field_types:
            gradient_position: Optional[GradientPosition]
            canvas_position: Optional[CanvasPosition]
          field_defaults:
            image_url: '""'
        - schema: BackgroundImageInfo1
          name: BotBackgroundImageInfo
          field_order:
            - web_background_image
            - mobile_background_image
          field_types:
            web_background_image: Optional[BackgroundImageInfo]
            mobile_background_image: Optional[BackgroundImageInfo]
        - schema: VariableType
          name: VariableType
          enum_base: dynamic_str
          enum_values:
            - name: KVVariable
              value: KVVariable
            - name: ListVariable
              value: ListVariable
        - schema: VariableChannel
          name: VariableChannel
          enum_base: dynamic_str
          enum_values:
            - name: VariableChannelCustom
              value: custom
            - name: VariableChannelSystem
              value: system
            - name: VariableChannelLocation
              value: location
            - name: VariableChannelFeishu
              value: feishu
            - name: VariableChannelAPP
              value: app
        - schema: Variable
          name: BotVariable
          field_order:
            - keyword
            - default_value
            - variable_type
            - channel
            - description
            - enable
            - prompt_enable
          required_fields:
            - keyword
            - default_value
            - variable_type
            - channel
            - description
            - enable
            - prompt_enable
          field_types:
            channel: VariableChannel
          extra_fields:
            - name: variable_type
              type: VariableType
              required: true
        - schema: Voice
          name: BotVoiceInfo
          field_order:
            - voice_id
            - language_code
          required_fields:
            - voice_id
            - language_code
        - name: UserInputType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: TEXT
              value: text
            - name: CALL
              value: call
            - name: VOICE
              value: voice
        - schema: WorkflowInfo
          name: BotWorkflowInfo
          field_order:
            - id
            - name
            - description
            - icon_url
          required_fields:
            - id
            - name
            - description
            - icon_url
        - schema: BotInfo
          name: Bot
          exclude_unordered_fields: true
          required_fields:
            - bot_id
          field_types:
            prompt_info: Optional[BotPromptInfo]
            onboarding_info: Optional[BotOnboardingInfo]
            knowledge: Optional[BotKnowledge]
            bot_mode: Optional[BotMode]
            plugin_info_list: Optional[List[BotPluginInfo]]
            model_info: Optional[BotModelInfo]
            suggest_reply_info: Optional[BotSuggestReplyInfo]
            background_image_info: Optional[BotBackgroundImageInfo]
            variables: Optional[List[BotVariable]]
            voice_info_list: Optional[List[BotVoiceInfo]]
            default_user_input_type: Optional[UserInputType]
            workflow_info_list: Optional[List[BotWorkflowInfo]]
          field_order:
            - bot_id
            - name
            - description
            - icon_url
            - create_time
            - update_time
            - version
            - prompt_info
            - onboarding_info
            - knowledge
            - bot_mode
            - plugin_info_list
            - model_info
            - suggest_reply_info
            - background_image_info
            - variables
            - owner_user_id
            - voice_info_list
            - default_user_input_type
            - workflow_info_list
            - folder_id
          extra_fields:
            - name: suggest_reply_info
              type: BotSuggestReplyInfo
              required: false
            - name: folder_id
              type: str
              required: false
        - schema: BotSimpleInfo
          name: SimpleBot
          field_order:
            - id
            - name
            - description
            - icon_url
            - is_published
            - updated_at
            - owner_user_id
            - folder_id
            - published_at
          required_fields:
            - id
            - name
            - description
            - icon_url
            - is_published
            - updated_at
            - owner_user_id
          extra_fields:
            - name: folder_id
              type: str
              required: false
          extra_code:
            - |
              bot_id: str = Field(alias="id")
              bot_name: str = Field(alias="name")
              publish_time: str = Field(alias="updated_at")

              @field_validator("publish_time", mode="before")
              @classmethod
              def convert_to_string(cls, v):
                  if isinstance(v, int):
                      return str(v)
                  return v
      empty_models:
        - UpdateBotResp
        - UnpublishBotResp
      top_level_code:
        - |
          class _PrivateListBotsDataV1(CozeModel, NumberPagedResponse[SimpleBot]):
              class SimpleBotV1(CozeModel):
                  bot_id: str
                  bot_name: str
                  description: str
                  icon_url: str
                  publish_time: str

                  def to_simple_bot(self) -> SimpleBot:
                      return SimpleBot(
                          id=self.bot_id,
                          name=self.bot_name,
                          description=self.description,
                          icon_url=self.icon_url,
                          is_published=True,
                          updated_at=int(self.publish_time),
                          owner_user_id="",
                          published_at=int(self.publish_time),
                      )

              space_bots: List[SimpleBotV1]
              total: int

              def get_total(self) -> Optional[int]:
                  return self.total

              def get_has_more(self) -> Optional[bool]:
                  return None

              def get_items(self) -> List[SimpleBot]:
                  return [bot.to_simple_bot() for bot in self.space_bots]
      override_pagination_classes:
        - _PrivateListBotsDataV1
      sync_extra_methods:
        - |
          def retrieve(
              self,
              *,
              bot_id: str,
              is_published: Optional[bool] = None,
              use_api_version: int = 1,
              **kwargs,
          ) -> Bot:
              if use_api_version == 1:
                  return self._retrieve_v1(bot_id=bot_id, **kwargs)
              if use_api_version == 2:
                  return self._retrieve_v2(bot_id=bot_id, is_published=is_published, **kwargs)
              raise ValueError("invalid use_api_version, expected one of: 1, 2")
        - |
          def list(
              self,
              *,
              space_id: str,
              publish_status: Optional[PublishStatus] = None,
              connector_id: Optional[str] = None,
              page_num: int = 1,
              page_size: int = 20,
              use_api_version: int = 2,
              **kwargs,
          ) -> NumberPaged[SimpleBot]:
              if use_api_version == 1:
                  return self._list_v1(
                      space_id=space_id,
                      page_num=page_num,
                      page_size=page_size,
                  )
              if use_api_version == 2:
                  return self._list_v2(
                      space_id=space_id,
                      publish_status=publish_status,
                      connector_id=connector_id,
                      page_num=page_num,
                      page_size=page_size,
                      **kwargs,
                  )
              raise ValueError("invalid use_api_version, expected one of: 1, 2")
      async_extra_methods:
        - |
          async def retrieve(
              self,
              *,
              bot_id: str,
              is_published: Optional[bool] = None,
              use_api_version: int = 1,
              **kwargs,
          ) -> Bot:
              if use_api_version == 1:
                  return await self._retrieve_v1(bot_id=bot_id, **kwargs)
              if use_api_version == 2:
                  return await self._retrieve_v2(bot_id=bot_id, is_published=is_published, **kwargs)
              raise ValueError("invalid use_api_version, expected one of: 1, 2")
        - |
          async def list(
              self,
              *,
              space_id: str,
              publish_status: Optional[PublishStatus] = None,
              connector_id: Optional[str] = None,
              page_num: int = 1,
              page_size: int = 20,
              use_api_version: int = 2,
              **kwargs,
          ) -> AsyncNumberPaged[SimpleBot]:
              if use_api_version == 1:
                  return await self._list_v1(
                      space_id=space_id,
                      page_num=page_num,
                      page_size=page_size,
                  )
              if use_api_version == 2:
                  return await self._list_v2(
                      space_id=space_id,
                      publish_status=publish_status,
                      connector_id=connector_id,
                      page_num=page_num,
                      page_size=page_size,
                      **kwargs,
                  )
              raise ValueError("invalid use_api_version, expected one of: 1, 2")
      path_prefixes:
        - /v1/bot
        - /v1/bots
    - name: chat
      source_dir: cozepy/chat
      extra_imports:
        - module: cozepy.model
          names:
            - ListResponse
            - Stream
      raw_imports:
        - import base64
        - import json
        - import time
        - import httpx
        - from typing import AsyncIterator, Union, overload
        - from cozepy.exception import CozeAPIError
        - from cozepy.model import AsyncIteratorHTTPResponse, AsyncStream, IteratorHTTPResponse
      child_clients:
        - attribute: messages
          module: .message
          sync_class: ChatMessagesClient
          async_class: AsyncChatMessagesClient
          nil_check: is_none
      model_schemas:
        - name: MessageRole
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: USER
              value: user
            - name: ASSISTANT
              value: assistant
        - name: MessageType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: UNKNOWN
              value: ""
            - name: QUESTION
              value: question
            - name: ANSWER
              value: answer
            - name: FUNCTION_CALL
              value: function_call
            - name: TOOL_OUTPUT
              value: tool_output
            - name: TOOL_RESPONSE
              value: tool_response
            - name: FOLLOW_UP
              value: follow_up
            - name: VERBOSE
              value: verbose
        - name: MessageContentType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: TEXT
              value: text
            - name: OBJECT_STRING
              value: object_string
            - name: CARD
              value: card
            - name: AUDIO
              value: audio
        - name: MessageObjectStringType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: TEXT
              value: text
            - name: FILE
              value: file
            - name: IMAGE
              value: image
            - name: AUDIO
              value: audio
        - name: MessageObjectString
          allow_missing_in_swagger: true
          extra_fields:
            - name: type
              type: MessageObjectStringType
              required: true
            - name: text
              type: str
              required: false
            - name: file_id
              type: str
              required: false
            - name: file_url
              type: str
              required: false
          extra_code:
            - |
              @staticmethod
              def build_text(text: str):
                  return MessageObjectString(type=MessageObjectStringType.TEXT, text=text)

              @staticmethod
              def build_image(file_id: Optional[str] = None, file_url: Optional[str] = None):
                  if not file_id and not file_url:
                      raise ValueError("file_id or file_url must be specified")
                  return MessageObjectString(type=MessageObjectStringType.IMAGE, file_id=file_id, file_url=file_url)

              @staticmethod
              def build_file(file_id: Optional[str] = None, file_url: Optional[str] = None):
                  if not file_id and not file_url:
                      raise ValueError("file_id or file_url must be specified")
                  return MessageObjectString(type=MessageObjectStringType.FILE, file_id=file_id, file_url=file_url)

              @staticmethod
              def build_audio(file_id: Optional[str] = None, file_url: Optional[str] = None):
                  if not file_id and not file_url:
                      raise ValueError("file_id or file_url must be specified")
                  return MessageObjectString(type=MessageObjectStringType.AUDIO, file_id=file_id, file_url=file_url)
        - schema: InsertedAdditionalMessage
          name: InsertedMessage
          required_fields:
            - id
        - schema: ChatV3ChatDetail
          name: Chat
          exclude_unordered_fields: true
          required_fields:
            - __none__
            - id
            - conversation_id
          field_types:
            meta_data: Optional[Dict[str, str]]
            last_error: Optional[ChatError]
            status: ChatStatus
            required_action: Optional[ChatRequiredAction]
            usage: Optional[ChatUsage]
          field_defaults:
            status: ChatStatus.UNKNOWN
          field_order:
            - id
            - conversation_id
            - bot_id
            - created_at
            - completed_at
            - failed_at
            - meta_data
            - last_error
            - status
            - required_action
            - usage
            - inserted_additional_messages
          extra_fields:
            - name: inserted_additional_messages
              type: List[InsertedMessage]
              required: false
        - schema: ChatV3MessageDetail
          name: Message
          exclude_unordered_fields: true
          required_fields:
            - __none__
            - role
            - type
            - content
            - content_type
          field_types:
            role: MessageRole
            type: MessageType
            content_type: MessageContentType
            meta_data: Optional[Dict[str, str]]
          field_defaults:
            type: MessageType.UNKNOWN
          field_order:
            - role
            - type
            - content
            - content_type
            - meta_data
            - id
            - conversation_id
            - section_id
            - bot_id
            - chat_id
            - created_at
            - updated_at
            - reasoning_content
          extra_code:
            - |
              @staticmethod
              def build_user_question_text(content: str, meta_data: Optional[Dict[str, str]] = None) -> "Message":
                  return Message(
                      role=MessageRole.USER,
                      type=MessageType.QUESTION,
                      content=content,
                      content_type=MessageContentType.TEXT,
                      meta_data=meta_data,
                  )

              @staticmethod
              def build_user_question_objects(
                  objects: List[MessageObjectString], meta_data: Optional[Dict[str, str]] = None
              ) -> "Message":
                  return Message(
                      role=MessageRole.USER,
                      type=MessageType.QUESTION,
                      content=json.dumps([obj.model_dump() for obj in objects]),
                      content_type=MessageContentType.OBJECT_STRING,
                      meta_data=meta_data,
                  )

              @staticmethod
              def build_assistant_answer(content: str, meta_data: Optional[Dict[str, str]] = None) -> "Message":
                  return Message(
                      role=MessageRole.ASSISTANT,
                      type=MessageType.ANSWER,
                      content=content,
                      content_type=MessageContentType.TEXT,
                      meta_data=meta_data,
                  )

              def get_audio(self) -> Optional[bytes]:
                  if self.content_type == MessageContentType.AUDIO:
                      return base64.b64decode(self.content)
                  return b""
        - name: ChatStatus
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: UNKNOWN
              value: ""
            - name: CREATED
              value: created
            - name: IN_PROGRESS
              value: in_progress
            - name: COMPLETED
              value: completed
            - name: FAILED
              value: failed
            - name: REQUIRES_ACTION
              value: requires_action
            - name: CANCELED
              value: canceled
        - schema: LastError
          name: ChatError
          field_defaults:
            code: "0"
            msg: '""'
        - name: ChatRequiredActionType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: UNKNOWN
              value: ""
            - name: SUBMIT_TOOL_OUTPUTS
              value: submit_tool_outputs
        - name: ChatToolCallType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: FUNCTION
              value: function
            - name: REPLY_MESSAGE
              value: reply_message
        - schema: RequiredAction
          name: ChatRequiredAction
          required_fields:
            - type
          field_types:
            type: ChatRequiredActionType
            submit_tool_outputs: Optional[ChatSubmitToolOutputs]
        - schema: SubmitToolOutputs
          name: ChatSubmitToolOutputs
          required_fields:
            - tool_calls
          field_types:
            tool_calls: List[ChatToolCall]
        - schema: InterruptPlugin
          name: ChatToolCall
          required_fields:
            - id
            - type
          field_types:
            type: ChatToolCallType
            function: Optional[ChatToolCallFunction]
        - schema: InterruptFunction
          name: ChatToolCallFunction
          required_fields:
            - name
            - arguments
        - schema: Usage2
          name: ChatUsage
          field_defaults:
            token_count: "0"
            output_count: "0"
            input_count: "0"
        - name: ChatPoll
          allow_missing_in_swagger: true
          extra_fields:
            - name: chat
              type: Chat
              required: true
            - name: messages
              type: ListResponse[Message]
              required: false
        - name: ChatEventType
          allow_missing_in_swagger: true
          enum_base: dynamic_str
          enum_values:
            - name: CONVERSATION_CHAT_CREATED
              value: conversation.chat.created
            - name: CONVERSATION_CHAT_IN_PROGRESS
              value: conversation.chat.in_progress
            - name: CONVERSATION_MESSAGE_DELTA
              value: conversation.message.delta
            - name: CONVERSATION_MESSAGE_COMPLETED
              value: conversation.message.completed
            - name: CONVERSATION_CHAT_COMPLETED
              value: conversation.chat.completed
            - name: CONVERSATION_CHAT_FAILED
              value: conversation.chat.failed
            - name: CONVERSATION_CHAT_REQUIRES_ACTION
              value: conversation.chat.requires_action
            - name: CONVERSATION_AUDIO_DELTA
              value: conversation.audio.delta
            - name: ERROR
              value: error
            - name: DONE
              value: done
            - name: UNKNOWN
              value: unknown
        - name: ChatEvent
          allow_missing_in_swagger: true
          extra_fields:
            - name: event
              type: ChatEventType
              required: true
            - name: chat
              type: Chat
              required: false
            - name: message
              type: Message
              required: false
            - name: unknown
              type: Dict[str, Any]
              required: false
        - schema: ToolOutput
          name: ToolOutput
          required_fields:
            - tool_call_id
            - output
      top_level_code:
        - |
          def _chat_stream_handler(data: Dict, raw_response: httpx.Response) -> Optional[ChatEvent]:
              event = data["event"]
              event_data = data["data"]
              if event == ChatEventType.DONE:
                  return None
              if event == ChatEventType.ERROR:
                  raise Exception(f"error event: {event_data}")
              if event in [
                  ChatEventType.CONVERSATION_MESSAGE_DELTA,
                  ChatEventType.CONVERSATION_MESSAGE_COMPLETED,
                  ChatEventType.CONVERSATION_AUDIO_DELTA,
              ]:
                  parsed = ChatEvent(event=event, message=Message.model_validate_json(event_data))
                  parsed._raw_response = raw_response
                  return parsed
              if event in [
                  ChatEventType.CONVERSATION_CHAT_CREATED,
                  ChatEventType.CONVERSATION_CHAT_IN_PROGRESS,
                  ChatEventType.CONVERSATION_CHAT_COMPLETED,
                  ChatEventType.CONVERSATION_CHAT_FAILED,
                  ChatEventType.CONVERSATION_CHAT_REQUIRES_ACTION,
              ]:
                  parsed = ChatEvent(event=event, chat=Chat.model_validate_json(event_data))
                  parsed._raw_response = raw_response
                  return parsed
              parsed = ChatEvent(event=ChatEventType.UNKNOWN, unknown=data)
              parsed._raw_response = raw_response
              return parsed
      sync_extra_methods:
        - |
          def create_and_poll(
              self,
              *,
              bot_id: str,
              user_id: str,
              conversation_id: Optional[str] = None,
              additional_messages: Optional[List[Message]] = None,
              custom_variables: Optional[Dict[str, str]] = None,
              auto_save_history: bool = True,
              meta_data: Optional[Dict[str, str]] = None,
              poll_timeout: Optional[int] = None,
              parameters: Optional[Dict[str, Any]] = None,
          ) -> ChatPoll:
              chat = self.create(
                  bot_id=bot_id,
                  user_id=user_id,
                  conversation_id=conversation_id,
                  additional_messages=additional_messages,
                  custom_variables=custom_variables,
                  auto_save_history=auto_save_history,
                  meta_data=meta_data,
                  parameters=parameters,
              )

              start = int(time.time())
              interval = 1
              while chat.status == ChatStatus.IN_PROGRESS:
                  if poll_timeout is not None and int(time.time()) - start > poll_timeout:
                      try:
                          self.cancel(conversation_id=chat.conversation_id, chat_id=chat.id)
                          return ChatPoll(chat=chat)
                      except CozeAPIError as e:
                          if e.code == 4104:
                              chat = self.retrieve(conversation_id=chat.conversation_id, chat_id=chat.id)
                              continue
                          raise e

                  time.sleep(interval)
                  chat = self.retrieve(conversation_id=chat.conversation_id, chat_id=chat.id)

              messages = self.messages.list(conversation_id=chat.conversation_id, chat_id=chat.id)
              return ChatPoll(chat=chat, messages=messages)
      path_prefixes:
        - /v3/chat
    - name: connectors
      source_dir: cozepy/connectors
      child_clients:
        - attribute: bots
          module: .bots
          sync_class: ConnectorsBotsClient
          async_class: AsyncConnectorsBotsClient
          disable_type_hints: true
      path_prefixes:
        - /v1/connectors
    - name: conversations
      source_dir: cozepy/conversations
      http_request_from_model: true
      extra_imports:
        - module: cozepy.chat
          names:
            - Message
      child_clients:
        - attribute: messages
          module: .message
          sync_class: MessagesClient
          async_class: AsyncMessagesClient
          disable_type_hints: true
      model_schemas:
        - schema: ConversationData
          name: Conversation
          required_fields:
            - id
            - created_at
            - meta_data
            - last_section_id
          field_types:
            meta_data: Dict[str, str]
          field_order:
            - id
            - created_at
            - meta_data
            - last_section_id
            - name
            - updated_at
            - creator_id
            - connector_id
        - schema: Section
          name: Section
          required_fields:
            - id
            - conversation_id
      empty_models:
        - DeleteConversationResp
      path_prefixes:
        - /v1/conversation
        - /v1/conversations
    - name: datasets
      source_dir: cozepy/datasets
      http_request_from_model: true
      child_clients:
        - attribute: documents
          module: .documents
          sync_class: DatasetsDocumentsClient
          async_class: AsyncDatasetsDocumentsClient
          nil_check: is_none
          init_with_keywords: true
        - attribute: images
          module: .images
          sync_class: DatasetsImagesClient
          async_class: AsyncDatasetsImagesClient
          nil_check: is_none
          init_with_keywords: true
      extra_imports:
        - module: cozepy.datasets.documents
          names:
            - DocumentChunkStrategy
            - DocumentFormatType
            - DocumentStatus
            - DocumentUpdateType
        - module: cozepy.model
          names:
            - ListResponse
      model_schemas:
        - schema: CreateDatasetOpenApiData
          name: CreateDatasetResp
          required_fields:
            - dataset_id
        - schema: DatasetStatus
          name: DatasetStatus
          enum_base: int
          enum_values:
            - name: ENABLED
              value: 1
            - name: DISABLED
              value: 3
        - schema: Dataset
          name: Dataset
          exclude_unordered_fields: true
          required_fields:
            - dataset_id
            - name
            - description
            - space_id
            - status
            - format_type
          field_types:
            status: DatasetStatus
            format_type: DocumentFormatType
            chunk_strategy: Optional[DocumentChunkStrategy]
          field_defaults:
            can_edit: "False"
            icon_url: '""'
            doc_count: "0"
            file_list: "[]"
            hit_count: "0"
            bot_used_count: "0"
            slice_count: "0"
            all_file_size: "0"
            failed_file_list: "[]"
            processing_file_list: "[]"
            processing_file_id_list: "[]"
            avatar_url: '""'
            creator_id: '""'
            creator_name: '""'
            create_time: "0"
            update_time: "0"
          field_order:
            - dataset_id
            - name
            - description
            - space_id
            - status
            - format_type
            - can_edit
            - icon_url
            - doc_count
            - file_list
            - hit_count
            - bot_used_count
            - slice_count
            - all_file_size
            - chunk_strategy
            - failed_file_list
            - processing_file_list
            - processing_file_id_list
            - avatar_url
            - creator_id
            - creator_name
            - create_time
            - update_time
        - schema: DocumentProgress
          name: DocumentProgress
          field_order:
            - document_id
            - url
            - size
            - type
            - status
            - progress
            - update_type
            - document_name
            - remaining_time
            - status_descript
            - update_interval
          required_fields:
            - status
            - update_type
          field_types:
            status: DocumentStatus
            update_type: DocumentUpdateType
          field_defaults:
            document_id: '""'
            url: '""'
            size: "0"
            type: '""'
            progress: "0"
            document_name: '""'
            remaining_time: "0"
            status_descript: '""'
            update_interval: "0"
      empty_models:
        - UpdateDatasetRes
        - DeleteDatasetRes
      path_prefixes:
        - /v1/datasets
    - name: enterprises
      source_dir: cozepy/enterprises
      child_clients:
        - attribute: members
          module: .members
          sync_class: EnterprisesMembersClient
          async_class: AsyncEnterprisesMembersClient
      path_prefixes:
        - /v1/enterprises
    - name: files
      source_dir: cozepy/files
      path_prefixes:
        - /v1/files
    - name: folders
      source_dir: cozepy/folders
      http_request_from_model: true
      model_schemas:
        - schema: FolderType
          name: FolderType
          enum_base: dynamic_str
        - schema: FolderSimpleInfo
          name: SimpleFolder
          field_order:
            - id
            - name
            - description
            - workspace_id
            - creator_user_id
            - folder_type
            - parent_folder_id
          required_fields:
            - id
            - name
            - description
            - workspace_id
            - creator_user_id
            - folder_type
          extra_fields:
            - name: children_count
              type: int
              required: false
      path_prefixes:
        - /v1/folders
    - name: knowledge
      source_dir: cozepy/knowledge
      path_prefixes:
        - /open_api/knowledge/document
    - name: templates
      source_dir: cozepy/templates
      path_prefixes:
        - /v1/templates
      allow_missing_in_swagger: true
    - name: users
      source_dir: cozepy/users
      path_prefixes:
        - /v1/users
      allow_missing_in_swagger: true
    - name: variables
      source_dir: cozepy/variables
      path_prefixes:
        - /v1/variables
    - name: workflows
      source_dir: cozepy/workflows
      path_prefixes:
        - /v1/workflow
        - /v1/workflows
    - name: workspaces
      source_dir: cozepy/workspaces
      path_prefixes:
        - /v1/workspaces
    - name: websockets
      source_dir: cozepy/websockets
      allow_missing_in_swagger: true
  operation_mappings:
    - path: /v3/chat
      method: post
      order: 1
      sdk_methods:
        - chat.create
      query_fields:
        - name: conversation_id
          type: str
          required: false
      body_fields:
        - bot_id
        - user_id
        - additional_messages
        - custom_variables
        - auto_save_history
        - meta_data
        - parameters
      body_fixed_values:
        stream: "False"
      body_required_fields:
        - bot_id
        - user_id
      arg_types:
        additional_messages: List[Message]
        custom_variables: Dict[str, str]
        meta_data: Dict[str, str]
        parameters: Dict[str, Any]
      disable_headers_arg: true
      response_type: Chat
      response_cast: Chat
    - path: /v3/chat
      method: post
      order: 2
      sdk_methods:
        - chat.stream
      query_fields:
        - name: conversation_id
          type: str
          required: false
      body_fields:
        - bot_id
        - user_id
        - additional_messages
        - custom_variables
        - auto_save_history
        - meta_data
        - enable_card
        - parameters
      body_fixed_values:
        stream: "True"
      body_required_fields:
        - bot_id
        - user_id
      arg_types:
        additional_messages: List[Message]
        custom_variables: Dict[str, str]
        meta_data: Dict[str, str]
        parameters: Dict[str, Any]
      disable_headers_arg: true
      request_stream: true
      response_type: Stream[ChatEvent]
      response_cast: None
    - path: /v3/chat/retrieve
      method: get
      order: 3
      sdk_methods:
        - chat.retrieve
      http_method_override: post
      disable_headers_arg: true
      response_type: Chat
      response_cast: Chat
    - path: /v3/chat/message/list
      method: get
      order: 4
      sdk_methods:
        - chat._messages_list
      disable_headers_arg: true
      response_type: ListResponse[Message]
      response_cast: ListResponse[Message]
    - path: /v3/chat/submit_tool_outputs
      method: post
      order: 5
      sdk_methods:
        - chat.submit_tool_outputs
      body_fields:
        - tool_outputs
        - stream
      body_required_fields:
        - tool_outputs
      arg_types:
        tool_outputs: List[ToolOutput]
      disable_headers_arg: true
      response_type: Chat
      response_cast: Chat
    - path: /v3/chat/cancel
      method: post
      order: 6
      sdk_methods:
        - chat.cancel
      body_fields:
        - chat_id
        - conversation_id
      body_required_fields:
        - chat_id
        - conversation_id
      disable_headers_arg: true
      response_type: Chat
      response_cast: Chat
    - path: /v1/api_apps
      method: post
      order: 10
      sdk_methods:
        - api_apps.create
      body_fields:
        - app_type
        - name
        - connector_id
      body_required_fields:
        - app_type
      use_kwargs_headers: true
      arg_types:
        app_type: AppType
      response_type: APIApp
      response_cast: APIApp
    - path: /v1/api_apps/{api_app_id}
      method: put
      order: 20
      sdk_methods:
        - api_apps.update
      body_fields:
        - name
        - callback_url
      use_kwargs_headers: true
      param_aliases:
        api_app_id: app_id
      response_type: UpdateAPIAppsResp
      response_cast: UpdateAPIAppsResp
    - path: /v1/api_apps/{api_app_id}
      method: put
      order: 30
      sdk_methods:
        - api_apps.delete
      http_method_override: delete
      disable_request_body: true
      use_kwargs_headers: true
      param_aliases:
        api_app_id: app_id
      response_type: DeleteAPIAppsResp
      response_cast: DeleteAPIAppsResp
    - path: /v1/api_apps
      method: post
      order: 40
      sdk_methods:
        - api_apps.list
      http_method_override: get
      disable_request_body: true
      use_kwargs_headers: true
      query_fields:
        - name: app_type
          type: AppType
          required: false
        - name: page_size
          type: int
          required: true
          default: "20"
        - name: page_token
          type: str
          required: true
          default: '""'
      pagination: token
      pagination_data_class: _PrivateListAPIAppsData
      pagination_item_type: APIApp
    - path: /v1/apps
      method: get
      order: 50
      sdk_methods:
        - apps.list
      query_builder: remove_none_values
      use_kwargs_headers: true
      query_fields:
        - name: workspace_id
          type: str
          required: true
        - name: page_size
          type: int
          required: true
          default: "20"
        - name: page_index
          type: int
          required: true
          default: "1"
        - name: publish_status
          type: PublishStatus
          required: false
          use_value: true
        - name: connector_id
          type: str
          required: false
      param_aliases:
        page_index: page_num
      pagination: number
      pagination_data_class: _PrivateListAppsData
      pagination_item_type: SimpleApp
      pagination_items_field: items
      pagination_total_field: total
      pagination_page_num_field: page_index
      pagination_page_size_field: page_size
    - path: /v1/conversation/create
      method: post
      order: 55
      sdk_methods:
        - conversations.create
      body_fields:
        - messages
        - bot_id
        - name
        - connector_id
        - meta_data
      arg_types:
        messages: List[Message]
        meta_data: Dict[str, str]
      disable_headers_arg: true
      response_type: Conversation
      response_cast: Conversation
    - path: /v1/conversation/retrieve
      method: get
      order: 56
      sdk_methods:
        - conversations.retrieve
      query_builder: raw
      disable_headers_arg: true
      response_type: Conversation
      response_cast: Conversation
    - path: /v1/conversations
      method: get
      order: 57
      sdk_methods:
        - conversations.list
      query_builder: raw
      pagination_inherit_response: false
      query_fields:
        - name: bot_id
          type: str
          required: true
        - name: page_num
          type: int
          required: true
          default: "1"
        - name: page_size
          type: int
          required: true
          default: "50"
      disable_headers_arg: true
      pagination: number_has_more
      pagination_data_class: _PrivateListConversationResp
      pagination_item_type: Conversation
      pagination_items_field: conversations
      pagination_has_more_field: has_more
      pagination_page_num_field: page_num
      pagination_page_size_field: page_size
    - path: /v1/conversations/{conversation_id}/clear
      method: post
      order: 58
      sdk_methods:
        - conversations.clear
      disable_request_body: true
      disable_headers_arg: true
      response_type: Section
      response_cast: Section
    - path: /v1/conversations/{conversation_id}
      method: put
      order: 59
      sdk_methods:
        - conversations.update
      body_fields:
        - name
      body_required_fields:
        - __none__
      disable_headers_arg: true
      response_type: Conversation
      response_cast: Conversation
    - path: /v1/conversations/{conversation_id}
      method: delete
      order: 60
      sdk_methods:
        - conversations.delete
      allow_missing_in_swagger: true
      disable_request_body: true
      disable_headers_arg: true
      response_type: DeleteConversationResp
      response_cast: DeleteConversationResp
    - path: /v1/datasets
      method: post
      order: 61
      sdk_methods:
        - datasets.create
      body_builder: raw
      allow_missing_in_swagger: true
      body_fields:
        - name
        - space_id
        - format_type
        - description
        - file_id
      body_required_fields:
        - name
        - space_id
        - format_type
      param_aliases:
        file_id: icon_file_id
      arg_types:
        name: str
        space_id: str
        format_type: DocumentFormatType
        description: str
        file_id: str
      disable_headers_arg: true
      response_type: CreateDatasetResp
      response_cast: CreateDatasetResp
    - path: /v1/datasets
      method: get
      order: 62
      sdk_methods:
        - datasets.list
      query_builder: raw
      use_kwargs_headers: true
      query_fields:
        - name: space_id
          type: str
          required: true
        - name: name
          type: str
          required: false
        - name: format_type
          type: DocumentFormatType
          required: false
        - name: page_size
          type: int
          required: true
          default: "10"
        - name: page_num
          type: int
          required: true
          default: "1"
      pagination: number
      pagination_data_class: _PrivateListDatasetsData
      pagination_item_type: Dataset
      pagination_items_field: dataset_list
      pagination_total_field: total_count
      pagination_page_num_field: page_num
      pagination_page_size_field: page_size
    - path: /v1/datasets/{dataset_id}
      method: put
      order: 63
      sdk_methods:
        - datasets.update
      body_builder: raw
      body_fields:
        - name
        - description
        - file_id
      param_aliases:
        file_id: icon_file_id
      disable_headers_arg: true
      response_type: UpdateDatasetRes
      response_cast: UpdateDatasetRes
    - path: /v1/datasets/{dataset_id}
      method: delete
      order: 64
      sdk_methods:
        - datasets.delete
      allow_missing_in_swagger: true
      disable_request_body: true
      disable_headers_arg: true
      response_type: DeleteDatasetRes
      response_cast: DeleteDatasetRes
    - path: /v1/datasets/{dataset_id}/process
      method: post
      order: 65
      sdk_methods:
        - datasets.process
      body_builder: raw
      body_fields:
        - document_ids
      disable_headers_arg: true
      ignore_header_params: true
      response_type: ListResponse[DocumentProgress]
      response_cast: ListResponse[DocumentProgress]
      data_field: data.data
    - path: /v1/bot/create
      method: post
      order: 66
      sdk_methods:
        - bots.create
      body_fields:
        - space_id
        - name
        - description
        - icon_file_id
        - prompt_info
        - onboarding_info
        - suggest_reply_info
        - model_info_config
        - plugin_id_list
        - workflow_id_list
      arg_types:
        prompt_info: BotPromptInfo
        onboarding_info: BotOnboardingInfo
        suggest_reply_info: BotSuggestReplyInfo
        model_info_config: BotModelInfo
        plugin_id_list: PluginIDList
        workflow_id_list: WorkflowIDList
      use_kwargs_headers: true
      response_type: Bot
      response_cast: Bot
    - path: /v1/bot/update
      method: post
      order: 67
      sdk_methods:
        - bots.update
      body_fields:
        - bot_id
        - name
        - description
        - icon_file_id
        - prompt_info
        - onboarding_info
        - knowledge
        - suggest_reply_info
        - model_info_config
      arg_types:
        prompt_info: BotPromptInfo
        onboarding_info: BotOnboardingInfo
        knowledge: BotKnowledge
        suggest_reply_info: BotSuggestReplyInfo
        model_info_config: BotModelInfo
      use_kwargs_headers: true
      response_type: UpdateBotResp
      response_cast: UpdateBotResp
    - path: /v1/bot/publish
      method: post
      order: 68
      sdk_methods:
        - bots.publish
      body_builder: raw
      body_fields:
        - bot_id
        - connector_ids
      body_required_fields:
        - bot_id
      use_kwargs_headers: true
      response_type: Bot
      response_cast: Bot
    - path: /v1/bots/{bot_id}/unpublish
      method: post
      order: 69
      sdk_methods:
        - bots.unpublish
      body_builder: raw
      body_fields:
        - connector_id
        - unpublish_reason
      use_kwargs_headers: true
      response_type: UnpublishBotResp
      response_cast: UnpublishBotResp
    - path: /v1/bot/get_online_info
      method: get
      order: 70
      sdk_methods:
        - bots._retrieve_v1
      use_kwargs_headers: true
      response_type: Bot
      response_cast: Bot
    - path: /v1/bots/{bot_id}
      method: get
      order: 71
      sdk_methods:
        - bots._retrieve_v2
      query_builder: remove_none_values
      use_kwargs_headers: true
      response_type: Bot
      response_cast: Bot
    - path: /v1/space/published_bots_list
      method: get
      order: 72
      sdk_methods:
        - bots._list_v1
      query_builder: raw
      disable_headers_arg: true
      query_fields:
        - name: space_id
          type: str
          required: true
        - name: page_size
          type: int
          required: true
          default: "20"
        - name: page_index
          type: int
          required: true
          default: "1"
      param_aliases:
        page_index: page_num
      pagination: number
      pagination_data_class: _PrivateListBotsDataV1
      pagination_item_type: SimpleBot
      pagination_items_field: space_bots
      pagination_total_field: total
      pagination_page_num_field: page_index
      pagination_page_size_field: page_size
    - path: /v1/bots
      method: get
      order: 73
      sdk_methods:
        - bots._list_v2
      query_builder: remove_none_values
      use_kwargs_headers: true
      query_fields:
        - name: workspace_id
          type: str
          required: true
        - name: publish_status
          type: PublishStatus
          required: false
          use_value: true
        - name: connector_id
          type: str
          required: false
        - name: page_size
          type: int
          required: true
          default: "20"
        - name: page_num
          type: int
          required: true
          default: "1"
      param_aliases:
        workspace_id: space_id
      pagination: number
      pagination_data_class: _PrivateListBotsDataV2
      pagination_item_type: SimpleBot
      pagination_items_field: items
      pagination_total_field: total
      pagination_page_num_field: page_num
      pagination_page_size_field: page_size
    - path: /v1/folders/{folder_id}
      method: get
      order: 74
      sdk_methods:
        - folders.retrieve
      use_kwargs_headers: true
      response_type: SimpleFolder
      response_cast: SimpleFolder
    - path: /v1/folders
      method: get
      order: 75
      sdk_methods:
        - folders.list
      use_kwargs_headers: true
      query_fields:
        - name: page_size
          type: int
          required: true
          default: "20"
        - name: page_num
          type: int
          required: true
          default: "1"
        - name: workspace_id
          type: str
          required: true
        - name: folder_type
          type: FolderType
          required: true
        - name: parent_folder_id
          type: str
          required: false
      pagination: number
      pagination_data_class: _PrivateListFoldersData
      pagination_item_type: SimpleFolder
      pagination_items_field: items
      pagination_total_field: total_count
      pagination_page_num_field: page_num
      pagination_page_size_field: page_size
    - path: /v1/workflows/chat
      method: post
      sdk_methods:
        - workflows.chat.create
        - workflows.chat.stream
    - path: /v1/workflow/run
      method: post
      sdk_methods:
        - workflows.runs.create
    - path: /v1/workflow/stream_run
      method: post
      sdk_methods:
        - workflows.runs.stream
    - path: /v1/templates/{template_id}/duplicate
      method: post
      sdk_methods:
        - templates.duplicate
      allow_missing_in_swagger: true
    - path: /v1/users/me
      method: get
      sdk_methods:
        - users.me
      allow_missing_in_swagger: true
  ignore_operations:
    - path: /v1/apps/{app_id}/collaborators
      method: post
    - path: /v1/apps/{app_id}/collaborators/{user_id}
      method: delete
    - path: /v1/audio/rooms
      method: post
    - path: /v1/audio/speech
      method: post
    - path: /v1/audio/transcriptions
      method: post
    - path: /v1/audio/voices
      method: get
    - path: /v1/audio/voices/clone
      method: post
    - path: /v1/connectors/{connector_id}/install
      method: post
    - path: /v1/connectors/{connector_id}/user_configs
      method: post
    - path: /v1/enterprises/{enterprise_id}/members
      method: post
    - path: /v1/enterprises/{enterprise_id}/members/{user_id}
      method: put
    - path: /v1/enterprises/{enterprise_id}/organizations
      method: post
    - path: /v1/api_apps/{api_app_id}/events
      method: post
    - path: /v1/commerce/benefit/benefits/get
      method: get
    - path: /v1/commerce/benefit/bill_tasks
      method: get
    - path: /v1/commerce/benefit/limitations
      method: post
    - path: /v1/conversation/message/create
      method: post
    - path: /v1/conversation/message/delete
      method: post
    - path: /v1/conversation/message/list
      method: post
    - path: /v1/conversation/message/modify
      method: post
    - path: /v1/conversation/message/retrieve
      method: get
    - path: /v3/chat/message/list
      method: get
    - path: /v1/conversations/{conversation_id}/messages/{message_id}/feedback
      method: delete
    - path: /v1/datasets/{dataset_id}/images
      method: get
    - path: /v1/bots/{bot_id}/collaboration_mode
      method: post
    - path: /v1/bots/{bot_id}/collaborators
      method: post
    - path: /v1/bots/{bot_id}/collaborators/{user_id}
      method: delete
    - path: /v1/bots/{bot_id}/versions
      method: get
  field_aliases:
    chat:
      custom_variables: custom_variables
      user_id: user_id
    workflows:
      workflow_id: workflow_id
      app_id: app_id
